<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>1A2B</title>
        <link rel="stylesheet" href="style.css">
    </head>

    <body>

        <div id="welcomePopup">
            <div class="popup-box">
                <button id="closeWelcome">âœ–</button>
                <h2>è²¼å¿ƒé«”é†’èˆ‡æ³¨æ„äº‹é …</h2>
                <p id="welcomeText">
                    æ­¤ç‚ºBetaç‰ˆæœ¬æ¸¬è©¦ï¼Œä¸¦éå®Œæ•´ç¶²é ï¼Œåªæš«æ™‚è¨­è¨ˆä¸€å€‹éŠæˆ²ï¼Œæ›´å¤§çš„å°ˆæ¡ˆä»æŒçºŒé–‹ç™¼ä¸­ã€‚(é è¨ˆæœƒèŠ±ä¸ŠæŒºé•·æ™‚é–“çš„ï¼Œç‚ºè§£è¬å…ƒç´ ï¼Œæœ‰ä»»ä½•æƒ³æ³•å¯ä»¥æä¾›ï¼Œæ„Ÿè¬)
                </p>
        </div>
    </div>

        <div id="lobby" style="display: block;">

            <h1 class="title">1A2BéŠæˆ²</h1>

            <div class="introduce">
                <h2>éŠæˆ²è¦å‰‡èªªæ˜:</h2>
                <p>1A2Bæ˜¯ä¸€æ¬¾ç¶“å…¸çš„é‚è¼¯æ¨ç†éŠæˆ²ï¼ç©å®¶éœ€è¦åœ¨æœ‰é™æ¬¡æ•¸å…§ï¼Œé€éä¸æ–·çŒœæ¸¬èˆ‡æç¤ºã€ŒAã€èˆ‡ã€ŒBã€çš„çµæœï¼Œæ‰¾å‡ºé›»è…¦éš¨æ©Ÿè¨­å®šçš„å››ä½ä¸é‡è¤‡æ•¸å­—ã€‚</p>
                <p>ã€ŒAã€ä»£è¡¨æ•¸å­—èˆ‡ä½ç½®çš†æ­£ç¢ºï¼Œã€ŒBã€å‰‡ä»£è¡¨æ•¸å­—æ­£ç¢ºä½†ä½ç½®éŒ¯èª¤ã€‚</p>
                <p>çœ‹ä¼¼ç°¡å–®å»å……æ»¿æŒ‘æˆ°ï¼Œä½ èƒ½åœ¨æœ€å°‘æ­¥æ•¸å…§çŒœå‡ºæ­£ç¢ºç­”æ¡ˆå—ï¼Ÿ</p>
            </div>

            <button id="start">è®“æˆ‘å€‘é–‹å§‹éŠæˆ²å§!</button>

        </div>

        <div class="game" id="main" style="display: none;">
            <!-- å¸Œæœ›å¯ä»¥ç•™ä¸€å€‹å€å¡Šçµ¦recordï¼Œä¾†å­˜æ”¾è³‡æ–™ -->
            <div class="hint" id="record"></div>
            <input type="number" id="userInput" placeholder="è«‹è¼¸å…¥ä½ èªç‚ºçš„å››ä½æ•´æ•¸æ•¸å­—">
            <button id="send">é€å‡º</button>

        </div>

        <!-- æˆåŠŸäº†ï¼Œå°±å½ˆå‡ºé¡¯ç¤ºæ¡† -->
        <div id="successPopup">
            <div class="popup-box">
                <h2>ğŸ‰ æ­å–œç­”å°ï¼</h2>
                <div id="time"></div>
                <p id="answerText"></p>
                <button id="restart">å†ç©ä¸€æ¬¡</button>
            </div>
        </div>
        <!-- æ–°å¢çµæŸ -->
        <footer>Â© 2025 lafa ï½œ æ‰€æœ‰å…§å®¹çš†å±¬ä½œè€…æ‰€æœ‰</footer>
    </body>

    <script>
        function $(q){
            return document.querySelector(q)
        }

        var start = $('#start');
        var lobby = $('#lobby');
        var receive = $('#send');
        var userInput = $('#userInput');
        var main = $('#main');
        var record = $('#record');
        var welcomePopup = $('#welcomePopup');
        var closeWelcome = $('#closeWelcome');

        // å½ˆçª—ç›¸é—œå…ƒç´ 
        var costtime = $('#time')
        var popup = $('#successPopup');
        var restart = $('#restart');
        var answerText = $('#answerText');
        //  æ–°å¢çµæŸend

        var answer = [];
        var times;

        // é è¨­é¡¯ç¤ºæ­¡è¿å½ˆçª—ï¼Œéš±è—å¤§å»³
    window.onload = function() {
        lobby.style.display = "none"; // å…ˆéš±è—å¤§å»³
        welcomePopup.classList.remove("hidden"); // é¡¯ç¤ºå½ˆçª—
    };

    // æŒ‰ä¸‹é—œé–‰å¾Œ â†’ é—œé–‰å½ˆçª—ã€é¡¯ç¤ºå¤§å»³
    closeWelcome.onclick = function() {
        welcomePopup.classList.add("hidden");
        setTimeout(() => {
            lobby.style.display = "block";
        }, 400); // çµ¦æ·¡å‡ºå‹•ç•«æ™‚é–“
    };

        function initiator(){

            answer = [];
            times = 0;

            
            while(answer.length < 4){
                let randomNum = Math.floor(Math.random() * 10);

                if(!answer.includes(randomNum)){
                    answer.push(randomNum);
                }
            }

            record.innerText = "";

            console.log(answer);
        }

        function inputcheck(){
            let inputInt = $('#userInput').value.trim(); //learn : trim:ä¿ç•™å‰å¾Œä¸€å€‹ç©ºç™½å­—å…ƒ(åŒ…æ‹¬0)
            console.log(inputInt);
            let intValue = parseInt(inputInt);
            let inputArray = [0,0,0,0];
            // æª¢æŸ¥é•·åº¦
            if (!/^\d{4}$/.test(inputInt)) {
                alert("è¼¸å…¥éŒ¯èª¤ï¼Œè«‹è¼¸å…¥å››ä½æ•´æ•¸ï¼");
                $('#userInput').value = "";
                return;
            }
            while(true){

                //check user input vaild or not
                while(true){
                    if(inputInt/1000 >= 10){
                        alert("è¼¸å…¥éŒ¯èª¤ï¼Œè«‹é‡æ–°è¼¸å…¥ä¸€å€‹å››ä½æ•´æ•¸å­—");
                        $('#userInput').value = "";
                        return;}                        
                    else if(intValue!=inputInt){
                        alert("è¼¸å…¥éŒ¯èª¤ï¼Œè«‹é‡æ–°è¼¸å…¥ä¸€å€‹å››ä½æ•´æ•¸å­—");
                        $('#userInput').value = "";
                        return;
                    }

                //make input -> array (help us to check the answer)
                inputArray[0] = parseInt(inputInt/1000);
                inputArray[1] = parseInt((inputInt-inputArray[0]*1000)/100);
                inputArray[2] = parseInt((inputInt-inputArray[0]*1000-inputArray[1]*100)/10);
                inputArray[3] = parseInt(inputInt%10);
                break;
                }
                for(i=0;i<=2;i++){
                    for(j=0;j<=3;j++){
                        if(i!=j){
                            if(inputArray[i]==inputArray[j]){
                                alert("è¼¸å…¥éŒ¯èª¤ï¼Œè«‹é‡æ–°è¼¸å…¥ä¸€å€‹å››ä½çš†ä¸åŒçš„æ•´æ•¸");
                                $('#userInput').value = "";
                                return;
                            }
                        }
                    }
                }
                console.log(inputArray);
                $('#userInput').value = "";
                let a = 0;
                let b = 0;
                for(i=0;i<=3;i++){
                    for(j=0;j<=3;j++){
                        if(i==j){
                            if(inputArray[i]==answer[j]){
                                a++;
                            }
                        }else{
                            if(inputArray[i]==answer[j]){
                                b++;
                            }
                        }
                        
                    }
                }
                times = times+1;

                // beta iiå¾ alert æ”¹ç‚ºé¡¯ç¤ºå½ˆçª—
                if(a==4){
                    answerText.textContent = "æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š" + answer.join('');
                    costtime.innerText = "ä½ ç¸½å…±èŠ±è²»äº†"+times+"æ¬¡ã€‚"
                    popup.classList.add("active");
                    return;
                }
                //  ä¿®æ”¹çµæŸ

                document.getElementById('record').innerHTML += inputInt + ":" + a + "A" + b + "B<br>";
                answercheck();
                return;
            }
        }

        function answercheck(){
            // é ç•™åŠŸèƒ½
        }

        start.onclick = function(){
            initiator();
            lobby.style.display = "none";
            main.style.display = "block";
            userInput.focus(); 
        }

        receive.onclick = function(){
            inputcheck();
        }

        // let Enter send (enter é€å‡ºè³‡æ–™)
        userInput.addEventListener("keypress", function(e){
            if(e.key === "Enter") inputcheck();
        });

        // beta ii æ–°å¢ï¼šé‡æ–°é–‹å§‹æŒ‰éˆ•
        restart.onclick = function(){
            popup.classList.remove("active");
            main.style.display = "none";
            lobby.style.display = "block";
            initiator();
        };
    </script>
</html>
